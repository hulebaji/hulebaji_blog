<!DOCTYPE html><html lang="en" data-theme="light"><head><!-- hexo injector head_begin start -->
          <script>
              (() => {
                  const sw = navigator.serviceWorker;
                  const error = () =>
        console.error(
          'Service Worker 注册失败！可能是由于您的浏览器不支持该功能！'
        );
                  if (!sw?.register('/sw.js')
                      
                      ?.catch(error)
                  ) error()
              })()
          </script><!-- hexo injector head_begin end --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>PS动画序列精灵表导出脚本 | 虎了吧唧</title><noscript>Please enable JavaScript to view the site</noscript><link rel="icon" href="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon"><!-- index.css--><link rel="stylesheet" href="/css/index.css?v=1.12.2"><!-- inject head--><link rel="canonical" href="https://blog.hulebaji.me/posts/51799/"><link rel="stylesheet" href="https://cdn2.codesign.qq.com/icons/7pOrz0WXB5ZWJPX/latest/iconfont.css"><!-- aplayer--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css"><!-- swiper--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css"><!-- fancybox ui--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.36/fancybox/fancybox.min.css"><!-- katex--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css"><!-- Open Graph--><meta name="description" content="PS动画序列精灵表脚本 搞游戏开发与影视特效的经常会遇到需要制作动画序列精灵表，在网上搜寻之后找到了这个ps脚本，方便快捷 以下是脚本原作者原文 Photoshop: Sprite Sheet Generator ScriptLast Updated - 1 January 0001 The"><!-- pwa--><meta name="theme-color" content="#006a73"><meta name="apple-mobile-web-app-status-bar-style" content="#006a73"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#006a73"><link rel="mask-icon" href="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon" color="#006a73"><link rel="apple-touch-icon" sizes="180x180" href="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon"><link rel="icon" type="image/png" sizes="16x16" href="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon"><link rel="icon" type="image/png" sizes="32x32" href="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon"><link rel="bookmark" href="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon"><script>console.log(
    "%c Program: Hexo %c Theme: Solitude %c Version: v1.12.2",
    "border-radius:5px 0 0 5px;padding: 5px 10px;color:white;background:#ff3842;",
    "padding: 5px 10px;color:white;background:#3e9f50;",
    "padding: 5px 10px;color:white;background:#0084ff;border-radius:0 5px 5px 0",
)
</script><script>let mdate = "7-8,9-18,12-13";
mdate = (mdate.split(","));
let ndate = new Date();
for (let i of mdate) {
    if (i === (ndate.getMonth()+1) + "-" + (ndate.getDate())) {
        document.documentElement.classList.add('memorial');
    }
}
</script><link rel="stylesheet" href="/css/custom.css"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"KKDiP3d0QcFRyp3T",ck:"KKDiP3d0QcFRyp3T"})</script><script>(()=>{
        const saveToLocal = {
            set: function setWithExpiry(key, value, ttl) {
                if (ttl === 0)
                    return
                const now = new Date()
                const expiryDay = ttl * 86400000
                const item = {
                    value: value,
                    expiry: now.getTime() + expiryDay
                }
                localStorage.setItem(key, JSON.stringify(item))
            },
            get: function getWithExpiry(key) {
                const itemStr = localStorage.getItem(key)
    
                if (!itemStr) {
                    return undefined
                }
                const item = JSON.parse(itemStr)
                const now = new Date()
    
                if (now.getTime() > item.expiry) {
                    localStorage.removeItem(key)
                    return undefined
                }
                return item.value
            }
        };
        window.utils = {
            saveToLocal: saveToLocal,
            getCSS: (url, id = false) => new Promise((resolve, reject) => {
              const link = document.createElement('link')
              link.rel = 'stylesheet'
              link.href = url
              if (id) link.id = id
              link.onerror = reject
              link.onload = link.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                link.onload = link.onreadystatechange = null
                resolve()
              }
              document.head.appendChild(link)
            }),
            getScript: (url, attr = {}) => new Promise((resolve, reject) => {
              const script = document.createElement('script')
              script.src = url
              script.async = true
              script.onerror = reject
              script.onload = script.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                script.onload = script.onreadystatechange = null
                resolve()
              }
    
              Object.keys(attr).forEach(key => {
                script.setAttribute(key, attr[key])
              })
    
              document.head.appendChild(script)
            }),
            addGlobalFn: (key, fn, name = false, parent = window) => {
                const globalFn = parent.globalFn || {}
                const keyObj = globalFn[key] || {}
        
                if (name && keyObj[name]) return
        
                name = name || Object.keys(keyObj).length
                keyObj[name] = fn
                globalFn[key] = keyObj
                parent.globalFn = globalFn
            },
        }
    })()</script><!-- global head--><script>const GLOBAL_CONFIG = {
    root: '/',
    algolia: {"appId":"MJJ9OG0Y7C","apiKey":"8fa4717cafa869d568330fbf9155780c","indexName":"hulebaji","hits":{"per_page":10}},
    localsearch: undefined,
    runtime: '2024-01-01 00:00:00',
    lazyload: {
        enable: true,
        error: '/img/error_load.webp'
    },
    copyright: {"limit":50,"author":"Author: Ian Tsang","link":"Link: ","source":"Source: 虎了吧唧","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."},
    highlight: {"limit":200,"expand":true,"copy":true,"syntax":"highlight.js"},
    randomlink: true,
    lang: {"theme":{"dark":"Dark","light":"Light"},"copy":{"success":"Copied","error":"Copy failed"},"backtop":"Back to top","time":{"day":" days ago","hour":" hours ago","just":"just","min":" minutes ago","month":" months ago"},"day":" days","f12":"Developer mode is turned on, please follow the GPL.","totalk":"You don't need to delete blank lines, just type in your comments.","search":{"empty":"No results found","hit":"Found ${query} results for you","placeholder":"Enter keywords to quickly search","count":"Total <b>${count}</b> results."},"barrage":{"title":"Hot"}},
    aside: {
        sayhello: {
            morning: '一日之计在于晨',
            noon: '吃饱了才有力气干活',
            afternoon: '集中精力，攻克难关',
            night: '不要太劳累了，早睡更健康',
            goodnight: '睡个好觉，保证精力充沛',
        },
        sayhello2: ["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多","🎮 电竞游戏爱好者"],
        sayhello3: {
            prefix: 'Long time no see,',
            back: 'Welcome back again,',
        },
    },
    covercolor: {
        enable: true
    },
    comment: {"avatar":"https://cravatar.cn","commentBarrage":true},
    lightbox: 'fancybox',
    post_ai: false,
    right_menu: false,
};</script><!-- page-config head--><script id="config-diff">var PAGE_CONFIG = {
    is_post: true,
    is_page: false,
    is_home: false,
    page: '',
    toc: true,
    comment: true,
    ai_text: false
}</script><!-- hexo injector head_end start --><script defer src="/sw-dom.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"></head><body id="body"><!-- universe--><canvas id="universe"></canvas><!-- loading--><!-- console--><div id="console"><div class="close-btn" onclick="sco.hideConsole()"><i class="solitude st-close-fill"></i></div><div class="console-card-group"><div class="console-card-group-right"><div class="console-card tags" onclick="sco.hideConsole()"><div class="card-content"><div class="author-content-item-tips">Tags</div><div class="author-content-item-title">Find interesting areas</div></div><div class="card-tag-cloud"><a href="/tags/Bug/">Bug<sup>1</sup></a><a href="/tags/Eth/">Eth<sup>1</sup></a><a href="/tags/Fix/">Fix<sup>1</sup></a><a href="/tags/LFS/">LFS<sup>1</sup></a><a href="/tags/NFT/">NFT<sup>1</sup></a><a href="/tags/Nuo/">Nuo<sup>1</sup></a><a href="/tags/PPT/">PPT<sup>1</sup></a><a href="/tags/Rig/">Rig<sup>1</sup></a><a href="/tags/SDK/">SDK<sup>1</sup></a><a href="/tags/ZKP/">ZKP<sup>1</sup></a><a href="/tags/Blog/">Blog<sup>2</sup></a><a href="/tags/Font/">Font<sup>1</sup></a><a href="/tags/HDRI/">HDRI<sup>1</sup></a><a href="/tags/Hexo/">Hexo<sup>1</sup></a><a href="/tags/Note/">Note<sup>8</sup></a><a href="/tags/Tech/">Tech<sup>19</sup></a><a href="/tags/Web3/">Web3<sup>2</sup></a><a href="/tags/Daily/">Daily<sup>1</sup></a><a href="/tags/Nvdia/">Nvdia<sup>1</sup></a><a href="/tags/PicGo/">PicGo<sup>1</sup></a><a href="/tags/Steam/">Steam<sup>1</sup></a><a href="/tags/Unity/">Unity<sup>1</sup></a><a href="/tags/Yi-Wu/">Yi Wu<sup>1</sup></a><a href="/tags/Browse/">Browse<sup>1</sup></a><a href="/tags/GasFee/">GasFee<sup>1</sup></a><a href="/tags/Github/">Github<sup>1</sup></a><a href="/tags/Nanite/">Nanite<sup>1</sup></a><a href="/tags/Office/">Office<sup>1</sup></a><a href="/tags/Plugin/">Plugin<sup>2</sup></a><a href="/tags/Script/">Script<sup>1</sup></a><a href="/tags/Anzhiyu/">Anzhiyu<sup>1</sup></a><a href="/tags/Blender/">Blender<sup>8</sup></a><a href="/tags/Cubemap/">Cubemap<sup>1</sup></a><a href="/tags/Systems/">Systems<sup>3</sup></a><a href="/tags/Windows/">Windows<sup>7</sup></a><a href="/tags/Material/">Material<sup>3</sup></a><a href="/tags/Backblaze/">Backblaze<sup>1</sup></a><a href="/tags/PhotoShop/">PhotoShop<sup>1</sup></a><a href="/tags/Soft-Ware/">Soft Ware<sup>1</sup></a><a href="/tags/Translate/">Translate<sup>1</sup></a><a href="/tags/Cloudflare/">Cloudflare<sup>1</sup></a><a href="/tags/Internship/">Internship<sup>1</sup></a><a href="/tags/Photo-Shop/">Photo Shop<sup>1</sup></a><a href="/tags/Application/">Application<sup>1</sup></a><a href="/tags/Unreal-Engine/">Unreal Engine<sup>5</sup></a><a href="/tags/Unreal-Enigine/">Unreal Enigine<sup>1</sup></a></div></div><div class="console-card history" onclick="sco.hideConsole()"><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">2024/02</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">2023/07</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">2023/06</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">2023/05</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">2023/04</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">2023/03</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">2023/02</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">2023/01</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">2022/12</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">2022/11</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">2022/10</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span class="card-archive-list-count-unit">Posts</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2000/03/"><span class="card-archive-list-date">2000/03</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">Posts</span></div></a></li></ul></div></div></div><div class="button-group"><div class="console-btn-item"><span class="darkmode_switchbutton" onclick="sco.switchDarkMode()" title="Day and night switching"><i class="solitude st-moon-clear-fill"></i></span></div><div class="console-btn-item" id="consoleHideAside"><span class="asideSwitch" onclick="sco.switchHideAside()" title="Sidebar display control"><i class="solitude st-side-bar-fill"></i></span></div><div class="console-btn-item" id="consoleMusic" onclick="sco.musicToggle()"><span class="music-switch" title="Music switch"><i class="solitude st-disc-fill"></i></span></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="sco.switchCommentBarrage()"><span class="commentBarrage"><i class="solitude st-chat-fill"></i></span></div></div><div class="console-mask" onclick="sco.hideConsole()"></div></div><!-- sidebar--><div id="sidebar" style="zoom: 1;"><div id="menu-mask" style="display: none;"></div><div id="sidebar-menus"><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Archives</div><div class="length-num">34</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">46</div></a></div></div></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><span class="darkmode_switchbutton menu-child" onclick="sco.switchDarkMode()"><i class="solitude st-moon-clear-fill"></i><span>Display mode</span></span></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://Nx8KKXil.jutuike.cn/#/?code=Nx8KKXil" title="吃喝玩乐鸭"><img class="nolazyload back-menu-item-icon" src="https://bu.dusays.com/2024/04/24/66287c463587e.ico" alt="吃喝玩乐鸭"><span class="back-menu-item-text">吃喝玩乐鸭</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>文章列表</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  st-checkbox-multiple-blank-fill"></i><span>全部分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>专栏</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Weekly/"><i class="solitude  iconfont hulebaji-weekly"></i><span>周刊</span></a></li><li><a class="site-page child" href="/categories/Project/"><i class="solitude  st-book-mark-fill"></i><span>项目</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/moments/"><i class="solitude  st-wifi-fill"></i><span>友链鱼塘</span></a></li><li><a class="site-page child" href="/links/"><i class="solitude  st-group-fill"></i><span>友情链接</span></a></li><li><a class="site-page child" href="/message/"><i class="solitude  iconfont hulebaji-message"></i><span>留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/equipment/"><i class="solitude  st-laptop-line"></i><span>装备</span></a></li><li><a class="site-page child" href="/tlink/"><i class="solitude  st-tools-fill"></i><span>工具箱</span></a></li><li><a class="site-page child" href="/books/"><i class="solitude  iconfont hulebaji-book"></i><span>阅读</span></a></li><li><a class="site-page child" href="/music/"><i class="solitude  st-disc-fill"></i><span>音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="solitude  st-contacts-fill"></i><span>关于本站</span></a></li></ul></div></div><span class="sidebar-menu-item-title">Tags</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class="card-tag-cloud"><a href="/tags/Bug/">Bug<sup>1</sup></a><a href="/tags/Eth/">Eth<sup>1</sup></a><a href="/tags/Fix/">Fix<sup>1</sup></a><a href="/tags/LFS/">LFS<sup>1</sup></a><a href="/tags/NFT/">NFT<sup>1</sup></a><a href="/tags/Nuo/">Nuo<sup>1</sup></a><a href="/tags/PPT/">PPT<sup>1</sup></a><a href="/tags/Rig/">Rig<sup>1</sup></a><a href="/tags/SDK/">SDK<sup>1</sup></a><a href="/tags/ZKP/">ZKP<sup>1</sup></a><a href="/tags/Blog/">Blog<sup>2</sup></a><a href="/tags/Font/">Font<sup>1</sup></a><a href="/tags/HDRI/">HDRI<sup>1</sup></a><a href="/tags/Hexo/">Hexo<sup>1</sup></a><a href="/tags/Note/">Note<sup>8</sup></a><a href="/tags/Tech/">Tech<sup>19</sup></a><a href="/tags/Web3/">Web3<sup>2</sup></a><a href="/tags/Daily/">Daily<sup>1</sup></a><a href="/tags/Nvdia/">Nvdia<sup>1</sup></a><a href="/tags/PicGo/">PicGo<sup>1</sup></a><a href="/tags/Steam/">Steam<sup>1</sup></a><a href="/tags/Unity/">Unity<sup>1</sup></a><a href="/tags/Yi-Wu/">Yi Wu<sup>1</sup></a><a href="/tags/Browse/">Browse<sup>1</sup></a><a href="/tags/GasFee/">GasFee<sup>1</sup></a><a href="/tags/Github/">Github<sup>1</sup></a><a href="/tags/Nanite/">Nanite<sup>1</sup></a><a href="/tags/Office/">Office<sup>1</sup></a><a href="/tags/Plugin/">Plugin<sup>2</sup></a><a href="/tags/Script/">Script<sup>1</sup></a><a href="/tags/Anzhiyu/">Anzhiyu<sup>1</sup></a><a href="/tags/Blender/">Blender<sup>8</sup></a><a href="/tags/Cubemap/">Cubemap<sup>1</sup></a><a href="/tags/Systems/">Systems<sup>3</sup></a><a href="/tags/Windows/">Windows<sup>7</sup></a><a href="/tags/Material/">Material<sup>3</sup></a><a href="/tags/Backblaze/">Backblaze<sup>1</sup></a><a href="/tags/PhotoShop/">PhotoShop<sup>1</sup></a><a href="/tags/Soft-Ware/">Soft Ware<sup>1</sup></a><a href="/tags/Translate/">Translate<sup>1</sup></a><a href="/tags/Cloudflare/">Cloudflare<sup>1</sup></a><a href="/tags/Internship/">Internship<sup>1</sup></a><a href="/tags/Photo-Shop/">Photo Shop<sup>1</sup></a><a href="/tags/Application/">Application<sup>1</sup></a><a href="/tags/Unreal-Engine/">Unreal Engine<sup>5</sup></a><a href="/tags/Unreal-Enigine/">Unreal Enigine<sup>1</sup></a></div></div></div></div><!-- keyboard--><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav class="show" id="nav"><div id="nav-group"><div id="blog_name"><div class="back-home-button" tabindex="-1"><i class="back-home-button-icon solitude st-more-fill"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://Nx8KKXil.jutuike.cn/#/?code=Nx8KKXil" title="吃喝玩乐鸭"><img class="nolazyload back-menu-item-icon" src="https://bu.dusays.com/2024/04/24/66287c463587e.ico" alt="吃喝玩乐鸭"><span class="back-menu-item-text">吃喝玩乐鸭</span></a></div></div></div></div><a id="site-name" href="/" title="Back to home"><span class="title">虎了吧唧</span></a></div><div id="page-name-mask"><div id="page-name"><a id="page-name-text" onclick="sco.toTop()">PS动画序列精灵表导出脚本</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>文章列表</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  st-checkbox-multiple-blank-fill"></i><span>全部分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>专栏</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Weekly/"><i class="solitude  iconfont hulebaji-weekly"></i><span>周刊</span></a></li><li><a class="site-page child" href="/categories/Project/"><i class="solitude  st-book-mark-fill"></i><span>项目</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/moments/"><i class="solitude  st-wifi-fill"></i><span>友链鱼塘</span></a></li><li><a class="site-page child" href="/links/"><i class="solitude  st-group-fill"></i><span>友情链接</span></a></li><li><a class="site-page child" href="/message/"><i class="solitude  iconfont hulebaji-message"></i><span>留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/equipment/"><i class="solitude  st-laptop-line"></i><span>装备</span></a></li><li><a class="site-page child" href="/tlink/"><i class="solitude  st-tools-fill"></i><span>工具箱</span></a></li><li><a class="site-page child" href="/books/"><i class="solitude  iconfont hulebaji-book"></i><span>阅读</span></a></li><li><a class="site-page child" href="/music/"><i class="solitude  st-disc-fill"></i><span>音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="solitude  st-contacts-fill"></i><span>关于本站</span></a></li></ul></div></div></div><div id="nav-left"></div><div id="nav-right"><div class="nav-button" id="travellings_button"><a class="site-page" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html" title=""><i class="solitude st-train-line"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="Random post" href="javascript:void(0);"><i class="solitude st-dice-line"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="Search"><i class="solitude st-search-line"></i></a></div><div class="nav-button" id="nav-console"><a class="console_switchbutton" onclick="sco.showConsole()" title="Console" href="javascript:void(0);"><i class="solitude st-dashboard-fill"></i></a></div><div class="nav-button" id="nav-totop" onclick="sco.toTop()"><a class="totopbtn"><i class="solitude st-arrow-up-line"></i><span id="percent">0</span></a></div><div id="toggle-menu"><a class="site-page"><i class="solitude st-menu-line"></i></a></div></div></div></nav><div class="coverdiv" id="coverdiv"><img class="nolazyload" id="post-cover" src="https://assets.hulebaji.me/2022/5d3ea6785dfd1d53e8330f9239dd94a1.webp" alt="PS动画序列精灵表导出脚本"></div><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original" title="This article is a Original article, pay attention to the copyright.">Original</a><span class="post-meta-categories"><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0-Note/">笔记/Note</a></span><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Script/"><span class="tags-name tags-punctuation">Script</span></a><a class="post-meta__tags" href="/tags/Photo-Shop/"><span class="tags-name tags-punctuation">Photo Shop</span></a></div></div></div></div><h1 class="post-title">PS动画序列精灵表导出脚本</h1><div id="post-meta"><div class="meta-secondline"><span class="post-meta-wordcount"><span class="post-meta-separator"></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="PS动画序列精灵表脚本"><a href="#PS动画序列精灵表脚本" class="headerlink" title="PS动画序列精灵表脚本"></a>PS动画序列精灵表脚本</h1><hr>
<pre><code>搞游戏开发与影视特效的经常会遇到需要制作动画序列精灵表，在网上搜寻之后找到了这个ps脚本，方便快捷
</code></pre>
<p><img src= "/img/loading.gif" data-lazy-src="https://assets.hulebaji.me/2022/5d3ea6785dfd1d53e8330f9239dd94a1.webp" alt="微信图片_20221111212228"></p>
<hr>
<h1 id="以下是脚本原作者原文"><a href="#以下是脚本原作者原文" class="headerlink" title="以下是脚本原作者原文"></a>以下是脚本原作者原文</h1><hr>
<h1 id="Photoshop-Sprite-Sheet-Generator-Script"><a href="#Photoshop-Sprite-Sheet-Generator-Script" class="headerlink" title="Photoshop: Sprite Sheet Generator Script"></a>Photoshop: Sprite Sheet Generator Script</h1><p>Last Updated - 1 January 0001</p>
<p>The Grimrock Model Toolkit is a mod-tool for the Legend of Grimrock. The GMT makes it easy to re-texture models in Legend of Grimrock Mods and a large number of the rextured and modder-created models on the Legend of Grimrock Mod Nexus were made using this tool.</p>
<p>This Photoshop Script has been put together to simplify the task of exporting a sprite sheet from a Photoshop file that contains Frame Animation data or a layer set containing 1 layer (or a sub-set) for each frame&#x2F;sprite that you would like on the resulting sprite sheet.</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://assets.hulebaji.me/2022/a1b62a52981503c105557f1fc85b69fd.png"></p>
<h2 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h2><p>You can download the latest version of the Sprite Sheet Generator script below.</p>
<p><a target="_blank" rel="noopener" href="https://www.johnwordsworth.com/downloads/ps-ssg/SpriteSheetGenerator0.6.0.zip">Sprite Sheet Generator - Version 0.6.0</a></p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>If you simply want to test the script out, then there is no install necessary. Just extract the .jsx file from the .zip file above and you should just be able to double click the script and it will run in Photoshop as if you had installed it and selected the relevant action from the menu. If that fails for some reason, you can drag and drop the script file onto Photoshop to run it once.</p>
<p>If you like the script and want to install it, follow these steps.</p>
<ol>
<li><p>Extract the .jsx file from the zip file above.</p>
</li>
<li><p>Copy and paste this file into your scripts presets folder:</p>
</li>
</ol>
<ul>
<li>OSX: &#x2F;Applications&#x2F;Adobe Photoshop &#x2F;Presets&#x2F;Scripts&#x2F;</li>
<li>Windows: C:\Program Files\Adobe\Adobe Photoshop \Presets\Scripts\</li>
</ul>
<ol start="3">
<li>Close and restart Photoshop.</li>
</ol>
<p>Once installed, you can run the script by selecting File -&gt; Scripts -&gt; Sprite Sheet Generator from the application’s menu.</p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>Once installed, you can run this script by going to File -&gt; Scripts -&gt; Sprite Sheet Generator from the application menu. Whenever you launch the script you will be presented with the following dialog…</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://assets.hulebaji.me/2022/b9c8e22f646fdb26a6c3b6e65dde40e4.png"></p>
<p>Sprite Sheet Generator Script Settings</p>
<p>This script opens a new document and copies all of your sprite data to that image. We try to leave your original document in the exact same state that we found it, but please do <strong>save your document before running this script</strong> just incase!</p>
<p>The settings serve the following purpose;</p>
<p><strong>Atlas Size:</strong> You can fix the width and&#x2F;or the height of the resulting sprite atlas. If you leave both set to ‘Auto’ then the smallest “power of two” texture size will be used. If only one setting is left to ‘Auto’ then the smallest POT value will be selected to fix the sprites. If you fix both, then your sprites might not fit - no warning will be issued!</p>
<p><strong>Sprite Source:</strong> You can select one of the following options for generating your  sprite sheet;</p>
<ul>
<li>“Frame Animation”: If you have setup your document as a Frame-based Animation then this will simply make each frame into a sprite and put them together on the resulting sprite sheet.</li>
<li>“Document Root Layers”: The script will go over every layer in the document root and make each layer a Sprite in the resulting Sprite sheet. If you have a background layer, this will be skipped. Note that only the visibility of the sprite layers will be toggled on&#x2F;off during the process. If you have background layers, you must decide whether you want them on every sprite or not by tweaking their visibility.</li>
<li>“Specific Layer Set”: You can select a layer set from the document and have each layer from that set used as a sprite. Once again, the script will not just capture that layer, but the entire image (all layers) with that the Sprite Layers turned on&#x2F;off. This gives you maximum flexibility as you can have effect layers above&#x2F;below your frames that appear on every sprite if you desire.</li>
</ul>
<p><strong>Ignore Child Layer Sets:</strong> In “Document Root Layers” or “Specific Layer Set” mode you can choose whether you want the script to treat layer sets (folders) within the given set of layers as sprites. If this tick box is checked, then all child layer sets are ignored (although their visibility is not changed from it’s initial setting). If you uncheck this box, they are treated as artwork layers, meaning each sprite in your sprite sheet can actually be a complicated group of other layers if you need that.</p>
<p><strong>Layer Set:</strong> In “Specific Layer Set” mode this is the set of layers to treat as your sprites.</p>
<p><strong>Flatten Image:</strong> Checking this box will flatten the resulting image. Otherwise, each sprite will remain as a separate layer.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>This script is released under a GPLv3 License. You’re free to use it for personal or commercial uses. Please just share any improvements that you make to the script with me and I’ll include them in future versions (and add your name to the credits of course!).</p>
<hr>
<h2 id="以下为脚本文件的解码（以防文件损失）"><a href="#以下为脚本文件的解码（以防文件损失）" class="headerlink" title="以下为脚本文件的解码（以防文件损失）"></a>以下为脚本文件的解码（以防文件损失）</h2><hr>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This script will export a sprite sheet as a new document given either a frame animation or a layered document.</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Author: John Wordsworth &lt;john@johnwordsworth.com&gt;</span></span><br><span class="line"><span class="comment">// Version: 0.6.0</span></span><br><span class="line"><span class="comment">// Date: June 2014</span></span><br><span class="line"><span class="comment">// Homepage: http://www.johnwordsworth.com/</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// This script is released under the GPLv3 Software License. You are free to use it for free or commercial purposes.</span></span><br><span class="line"><span class="comment">// If you make any modifications or improvements to this script, please do share them back with us.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Allows double clicking and opening in Photoshop</span></span><br><span class="line">#target photoshop</span><br><span class="line"></span><br><span class="line"><span class="comment">// debug level: 0-2 (0:disable, 1:break on error, 2:break at beginning)</span></span><br><span class="line"><span class="comment">//$.level = 1;</span></span><br><span class="line"><span class="comment">//debugger; // launch debugger on next line</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Constants</span></span><br><span class="line"><span class="keyword">const</span> kScriptTitle = <span class="string">&quot;Sprite Sheet Generator 0.6.0&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> kUserOptionsKey = <span class="string">&quot;userOptions&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsDocNameKey = <span class="string">&quot;documentName&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsAtlasWidthKey = <span class="string">&quot;atlasWidth&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsAtlasHeightKey = <span class="string">&quot;atlasHeight&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsSourceKey = <span class="string">&quot;frameSource&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsFlattenKey = <span class="string">&quot;flattenAtlas&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsLayerSetKey = <span class="string">&quot;layerSetIndex&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsIgnoreChildSetsKey = <span class="string">&quot;ignoreChildSets&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> kUserOptionsSourceFrameAnimation = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsSourceDocumentLayers = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> kUserOptionsSourceLayerSet = <span class="number">2</span>;    </span><br><span class="line"></span><br><span class="line"><span class="comment">// Script Result</span></span><br><span class="line"><span class="keyword">var</span> gScriptResult;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Run the Script</span></span><br><span class="line"><span class="keyword">try</span> &#123; </span><br><span class="line">    <span class="keyword">var</span> result = <span class="title function_">main</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( result === <span class="literal">false</span> ) &#123;</span><br><span class="line">        gScriptResult = <span class="string">&#x27;cancel&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        gScriptResult = <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">catch</span>( e ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( app.<span class="property">displayDialogs</span> != <span class="title class_">DialogModes</span>.<span class="property">NO</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title function_">alert</span>(e, kScriptTitle);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    gScriptResult = <span class="string">&#x27;cancel&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gScriptResult;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Main Method</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_">entryPoint</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( app.<span class="property">documents</span>.<span class="property">length</span> == <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&quot;No open documents.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Preparation</span></span><br><span class="line">    <span class="keyword">var</span> srcDoc = app.<span class="property">activeDocument</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Get the user&#x27;s input options</span></span><br><span class="line">    <span class="keyword">var</span> userOptions = <span class="title function_">getUserOptions</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( userOptions == <span class="literal">false</span> ) &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create the output document</span></span><br><span class="line">    <span class="keyword">var</span> destDoc = <span class="title function_">createDestDocWithOptions</span>(userOptions, srcDoc);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// If no destination doc, we didn&#x27;t make a sprite sheet</span></span><br><span class="line">    <span class="keyword">if</span> ( destDoc === <span class="literal">false</span> ) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&quot;No destination document was created - invalid input options?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// In the new document, we want to delete the white layer </span></span><br><span class="line">    app.<span class="property">activeDocument</span> = destDoc;</span><br><span class="line">    destDoc.<span class="property">layers</span>[destDoc.<span class="property">layers</span>.<span class="property">length</span>-<span class="number">1</span>].<span class="title function_">remove</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// At this point the new document is a stack of frames...</span></span><br><span class="line">    <span class="title function_">layoutLayersAsSprites</span>(userOptions, destDoc);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">exitPoint</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">entryPoint</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    prevRulerUnits = app.<span class="property">preferences</span>.<span class="property">rulerUnits</span>;</span><br><span class="line">    </span><br><span class="line">    app.<span class="property">preferences</span>.<span class="property">rulerUnits</span> = <span class="title class_">Units</span>.<span class="property">PIXELS</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">exitPoint</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    app.<span class="property">preferences</span>.<span class="property">rulerUnits</span> = prevRulerUnits;</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toTypeID</span>(<span class="params">stringID</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> app.<span class="title function_">stringIDToTypeID</span>(stringID);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">putActionDescValue</span>(<span class="params">desc, method, key, value</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ( key == <span class="literal">undefined</span> || value == <span class="literal">undefined</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    desc[method](<span class="title function_">toTypeID</span>(key), value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getActionDescValue</span>(<span class="params">desc, method, key, defaultValue</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ( desc.<span class="title function_">hasKey</span>(<span class="title function_">toTypeID</span>(key)) ) &#123;</span><br><span class="line">        <span class="keyword">return</span> desc[method](<span class="title function_">toTypeID</span>(key)); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> defaultValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">storeLastUserOptions</span>(<span class="params">userOptions</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> desc = <span class="keyword">new</span> <span class="title class_">ActionDescriptor</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">putActionDescValue</span>(desc, <span class="string">&quot;putString&quot;</span>, kUserOptionsDocNameKey, userOptions[kUserOptionsDocNameKey]);</span><br><span class="line">    <span class="title function_">putActionDescValue</span>(desc, <span class="string">&quot;putInteger&quot;</span>, kUserOptionsAtlasWidthKey, userOptions[kUserOptionsAtlasWidthKey]);</span><br><span class="line">    <span class="title function_">putActionDescValue</span>(desc, <span class="string">&quot;putInteger&quot;</span>, kUserOptionsAtlasHeightKey, userOptions[kUserOptionsAtlasHeightKey]);</span><br><span class="line">    <span class="title function_">putActionDescValue</span>(desc, <span class="string">&quot;putInteger&quot;</span>, kUserOptionsSourceKey, userOptions[kUserOptionsSourceKey]);</span><br><span class="line">    <span class="title function_">putActionDescValue</span>(desc, <span class="string">&quot;putBoolean&quot;</span>, kUserOptionsFlattenKey, userOptions[kUserOptionsFlattenKey]);</span><br><span class="line">    <span class="title function_">putActionDescValue</span>(desc, <span class="string">&quot;putInteger&quot;</span>, kUserOptionsLayerSetKey, userOptions[kUserOptionsLayerSetKey]);</span><br><span class="line">    <span class="title function_">putActionDescValue</span>(desc, <span class="string">&quot;putBoolean&quot;</span>, kUserOptionsIgnoreChildSetsKey, userOptions[kUserOptionsIgnoreChildSetsKey]);</span><br><span class="line">    </span><br><span class="line">    app.<span class="title function_">putCustomOptions</span>( kUserOptionsKey, desc, <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">retrieveLastUserOptions</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123; </span><br><span class="line">        <span class="keyword">var</span> desc = app.<span class="title function_">getCustomOptions</span>(kUserOptionsKey);</span><br><span class="line">    &#125; <span class="keyword">catch</span>( e ) &#123; <span class="keyword">return</span> &#123; &#125;; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> result = &#123; &#125;;</span><br><span class="line">    </span><br><span class="line">    result[kUserOptionsDocNameKey ] = <span class="title function_">getActionDescValue</span>(desc, <span class="string">&quot;getString&quot;</span>, kUserOptionsDocNameKey, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    result[kUserOptionsAtlasWidthKey] = <span class="title function_">getActionDescValue</span>(desc, <span class="string">&quot;getInteger&quot;</span>, kUserOptionsAtlasWidthKey, <span class="number">0</span>);</span><br><span class="line">    result[kUserOptionsAtlasHeightKey] = <span class="title function_">getActionDescValue</span>(desc, <span class="string">&quot;getInteger&quot;</span>, kUserOptionsAtlasHeightKey, <span class="number">0</span>);</span><br><span class="line">    result[kUserOptionsSourceKey] = <span class="title function_">getActionDescValue</span>(desc, <span class="string">&quot;getInteger&quot;</span>, kUserOptionsSourceKey, <span class="number">0</span>);    </span><br><span class="line">    result[kUserOptionsFlattenKey] = <span class="title function_">getActionDescValue</span>(desc, <span class="string">&quot;getBoolean&quot;</span>, kUserOptionsFlattenKey, <span class="literal">false</span>);        </span><br><span class="line">    result[kUserOptionsLayerSetKey] = <span class="title function_">getActionDescValue</span>(desc, <span class="string">&quot;getInteger&quot;</span>, kUserOptionsLayerSetKey, <span class="number">0</span>);    </span><br><span class="line">    result[kUserOptionsIgnoreChildSetsKey] = <span class="title function_">getActionDescValue</span>(desc, <span class="string">&quot;getBoolean&quot;</span>, kUserOptionsIgnoreChildSetsKey, <span class="literal">true</span>);        </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">indexOf</span>(<span class="params">array, obj</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>; k &lt; array.<span class="property">length</span>; ++k ) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ( array[k] == obj ) &#123;</span><br><span class="line">            <span class="keyword">return</span> k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUserOptions</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Note: When running from ExtendScript editor, editing the script soetimes destroys all previous options!</span></span><br><span class="line">    <span class="keyword">var</span> lastUserOptions = <span class="title function_">retrieveLastUserOptions</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If dialogs are turned off, we just return the last / default options</span></span><br><span class="line">    <span class="comment">//if ( app.playbackDisplayDialogs != DialogModes.ALL ) &#123;</span></span><br><span class="line">    <span class="comment">//    return lastUserOptions;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sizeItems = [<span class="string">&quot;Auto&quot;</span>, <span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">256</span>, <span class="number">512</span>, <span class="number">1024</span>, <span class="number">2048</span>, <span class="number">4096</span>];</span><br><span class="line">    <span class="keyword">var</span> sourceItems = [<span class="string">&quot;Frame Animation&quot;</span>, <span class="string">&quot;Document Root Layers&quot;</span>, <span class="string">&quot;Specific Layer Set&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> layerSetItems = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>( k = <span class="number">0</span>; k &lt; app.<span class="property">activeDocument</span>.<span class="property">layerSets</span>.<span class="property">length</span>; ++k ) &#123;</span><br><span class="line">        <span class="keyword">var</span> layerSet = app.<span class="property">activeDocument</span>.<span class="property">layerSets</span>[k];</span><br><span class="line">        layerSetItems[layerSetItems.<span class="property">length</span>] = layerSet.<span class="property">name</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( layerSetItems.<span class="property">length</span> == <span class="number">0</span> ) &#123; layerSetItems[<span class="number">0</span>] = <span class="string">&quot;No Layer Sets Available&quot;</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> dlg = <span class="keyword">new</span> <span class="title class_">Window</span>(<span class="string">&#x27;dialog&#x27;</span>, kScriptTitle);</span><br><span class="line">    </span><br><span class="line">    dlg.<span class="property">atlasSizeTitleGrp</span> = dlg.<span class="title function_">add</span>(<span class="string">&#x27;group&#x27;</span>, <span class="literal">undefined</span>);</span><br><span class="line">    dlg.<span class="property">atlasSizeTitleGrp</span>.<span class="property">alignment</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">    dlg.<span class="property">atlasSizeTitleGrp</span>.<span class="property">label01</span> = dlg.<span class="property">atlasSizeTitleGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;StaticText&#x27;</span>, <span class="literal">undefined</span>, <span class="string">&quot;Atlas Size (Pixels)&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span> = dlg.<span class="title function_">add</span>(<span class="string">&#x27;group&#x27;</span>, <span class="literal">undefined</span>, );</span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">orientation</span> = <span class="string">&quot;row&quot;</span>;</span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">alignment</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownWidth</span> = dlg.<span class="property">atlasSizeGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;DropDownList&#x27;</span>, <span class="literal">undefined</span>, sizeItems);</span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownWidth</span>.<span class="property">text</span> = <span class="string">&quot;Width: &quot;</span>;</span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownWidth</span>.<span class="property">selection</span> = <span class="number">0</span>;</span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownHeight</span> = dlg.<span class="property">atlasSizeGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;DropDownList&#x27;</span>, <span class="literal">undefined</span>, sizeItems);</span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownHeight</span>.<span class="property">text</span> = <span class="string">&quot;Height: &quot;</span>;    </span><br><span class="line">    dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownHeight</span>.<span class="property">selection</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    dlg.<span class="property">sourceTitleGrp</span> = dlg.<span class="title function_">add</span>(<span class="string">&#x27;group&#x27;</span>, <span class="literal">undefined</span>);</span><br><span class="line">    dlg.<span class="property">sourceTitleGrp</span>.<span class="property">alignment</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">    dlg.<span class="property">sourceTitleGrp</span>.<span class="property">label01</span> = dlg.<span class="property">sourceTitleGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;StaticText&#x27;</span>, <span class="literal">undefined</span>, <span class="string">&quot;Sprite Source&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    dlg.<span class="property">sourceGrp</span> = dlg.<span class="title function_">add</span>(<span class="string">&#x27;group&#x27;</span>, <span class="literal">undefined</span>);</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">orientation</span> = <span class="string">&quot;column&quot;</span>;</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">alignment</span> = <span class="string">&quot;left&quot;</span>;    </span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span> = dlg.<span class="property">sourceGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;DropDownList&#x27;</span>, <span class="literal">undefined</span>, sourceItems);</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span>.<span class="property">text</span> = <span class="string">&quot;Source: &quot;</span>;</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span>.<span class="property">selection</span> = <span class="number">0</span>;</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span>.<span class="property">onChange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line">        <span class="title function_">userOptionsDlgUpdateLayerSetChildControls</span>(dlg);</span><br><span class="line">    &#125;;</span><br><span class="line">   </span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownLayerSet</span> = dlg.<span class="property">sourceGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;DropDownList&#x27;</span>, <span class="literal">undefined</span>, layerSetItems);</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownLayerSet</span>.<span class="property">text</span> = <span class="string">&quot;Layer Set: &quot;</span>;</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownLayerSet</span>.<span class="property">selection</span> = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">ignoreChildSetsCheck</span> = dlg.<span class="property">sourceGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;CheckBox&#x27;</span>, <span class="literal">undefined</span>, <span class="string">&quot;Ignore Child Layer Sets&quot;</span>);</span><br><span class="line">    dlg.<span class="property">sourceGrp</span>.<span class="property">ignoreChildSetsCheck</span>.<span class="property">value</span> = <span class="literal">true</span>;    </span><br><span class="line"></span><br><span class="line">    dlg.<span class="property">otherTitleGrp</span> = dlg.<span class="title function_">add</span>(<span class="string">&#x27;group&#x27;</span>, <span class="literal">undefined</span>);</span><br><span class="line">    dlg.<span class="property">otherTitleGrp</span>.<span class="property">alignment</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">    dlg.<span class="property">otherTitleGrp</span>.<span class="property">label01</span> = dlg.<span class="property">otherTitleGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;StaticText&#x27;</span>, <span class="literal">undefined</span>, <span class="string">&quot;Other Options&quot;</span>);</span><br><span class="line"></span><br><span class="line">    dlg.<span class="property">flattenGrp</span> = dlg.<span class="title function_">add</span>(<span class="string">&#x27;group&#x27;</span>);</span><br><span class="line">    dlg.<span class="property">flattenGrp</span>.<span class="property">orientation</span> = <span class="string">&#x27;row&#x27;</span>;</span><br><span class="line">    dlg.<span class="property">flattenGrp</span>.<span class="property">alignment</span> = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">    dlg.<span class="property">flattenGrp</span>.<span class="property">flattenCheck</span> = dlg.<span class="property">flattenGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;CheckBox&#x27;</span>, <span class="literal">undefined</span>, <span class="string">&quot;Flatten Image?&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    dlg.<span class="property">buttonGrp</span> = dlg.<span class="title function_">add</span>(<span class="string">&#x27;group&#x27;</span>);</span><br><span class="line">    dlg.<span class="property">buttonGrp</span>.<span class="property">okButton</span> = dlg.<span class="property">buttonGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, <span class="string">&#x27;OK&#x27;</span>);</span><br><span class="line">    dlg.<span class="property">buttonGrp</span>.<span class="property">cancelButton</span> = dlg.<span class="property">buttonGrp</span>.<span class="title function_">add</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, <span class="string">&#x27;Cancel&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// Before presenting, update from user options (if applicable)</span></span><br><span class="line">    <span class="keyword">if</span> ( lastUserOptions[kUserOptionsAtlasWidthKey] &gt; <span class="number">0</span> ) &#123; dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownWidth</span>.<span class="property">selection</span> = <span class="title function_">indexOf</span>(sizeItems, lastUserOptions[kUserOptionsAtlasWidthKey]); &#125;</span><br><span class="line">    <span class="keyword">if</span> ( lastUserOptions[kUserOptionsAtlasHeightKey] &gt; <span class="number">0</span> ) &#123; dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownHeight</span>.<span class="property">selection</span> = <span class="title function_">indexOf</span>(sizeItems, lastUserOptions[kUserOptionsAtlasHeightKey]); &#125;</span><br><span class="line">    <span class="keyword">if</span> ( lastUserOptions[kUserOptionsSourceKey] &gt; <span class="number">0</span> ) &#123; dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span>.<span class="property">selection</span> = lastUserOptions[kUserOptionsSourceKey]; &#125;</span><br><span class="line">    <span class="keyword">if</span> ( lastUserOptions[kUserOptionsFlattenKey] !== <span class="literal">undefined</span> ) &#123; dlg.<span class="property">flattenGrp</span>.<span class="property">flattenCheck</span>.<span class="property">value</span> = lastUserOptions[kUserOptionsFlattenKey]; &#125;</span><br><span class="line">    <span class="keyword">if</span> ( lastUserOptions[kUserOptionsIgnoreChildSetsKey] !== <span class="literal">undefined</span> ) &#123; dlg.<span class="property">sourceGrp</span>.<span class="property">ignoreChildSetsCheck</span>.<span class="property">value</span> = lastUserOptions[kUserOptionsIgnoreChildSetsKey]; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( (lastUserOptions[kUserOptionsDocNameKey] == app.<span class="property">activeDocument</span>.<span class="property">name</span>) &amp;&amp; (lastUserOptions[kUserOptionsLayerSetKey] &lt; app.<span class="property">activeDocument</span>.<span class="property">layerSets</span>.<span class="property">length</span>) ) &#123;</span><br><span class="line">        dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownLayerSet</span>.<span class="property">selection</span> = lastUserOptions[kUserOptionsLayerSetKey];</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="title function_">userOptionsDlgUpdateLayerSetChildControls</span>(dlg);        </span><br><span class="line">    dlg.<span class="title function_">center</span>();</span><br><span class="line">    <span class="keyword">var</span> dlgResult = dlg.<span class="title function_">show</span>(); <span class="comment">// 1 = ok, 2 = cancel</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Note: .selection as a string is the value in the drop down, as an int it&#x27;s the item&#x27;s index!</span></span><br><span class="line">    <span class="keyword">var</span> userOptions = &#123; &#125;;</span><br><span class="line">    userOptions[kUserOptionsDocNameKey] = app.<span class="property">activeDocument</span>.<span class="property">name</span>;</span><br><span class="line">    userOptions[kUserOptionsAtlasWidthKey] = <span class="built_in">parseInt</span>(sizeItems[<span class="built_in">parseInt</span>(dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownWidth</span>.<span class="property">selection</span>)]);</span><br><span class="line">    userOptions[kUserOptionsAtlasHeightKey] = <span class="built_in">parseInt</span>(sizeItems[<span class="built_in">parseInt</span>(dlg.<span class="property">atlasSizeGrp</span>.<span class="property">dropDownHeight</span>.<span class="property">selection</span>)]);</span><br><span class="line">    userOptions[kUserOptionsSourceKey] = <span class="built_in">parseInt</span>(dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span>.<span class="property">selection</span>);</span><br><span class="line">    userOptions[kUserOptionsFlattenKey] = dlg.<span class="property">flattenGrp</span>.<span class="property">flattenCheck</span>.<span class="property">value</span>;</span><br><span class="line">    userOptions[kUserOptionsLayerSetKey] = <span class="built_in">parseInt</span>(dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownLayerSet</span>.<span class="property">selection</span>);</span><br><span class="line">    userOptions[kUserOptionsIgnoreChildSetsKey] = dlg.<span class="property">sourceGrp</span>.<span class="property">ignoreChildSetsCheck</span>.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">isNaN</span>(userOptions[kUserOptionsAtlasWidthKey]) ) &#123; userOptions[kUserOptionsAtlasWidthKey] = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">isNaN</span>(userOptions[kUserOptionsAtlasHeightKey]) ) &#123; userOptions[kUserOptionsAtlasHeightKey] = <span class="number">0</span>; &#125;   </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">storeLastUserOptions</span>(userOptions);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( dlgResult == <span class="number">2</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> userOptions;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">userOptionsDlgUpdateLayerSetChildControls</span>(<span class="params">dlg</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ( dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span>.<span class="property">selection</span> == kUserOptionsSourceLayerSet ) &#123;</span><br><span class="line">        dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownLayerSet</span>.<span class="property">visible</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownLayerSet</span>.<span class="property">visible</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( dlg.<span class="property">sourceGrp</span>.<span class="property">dropDownSource</span>.<span class="property">selection</span> == kUserOptionsSourceFrameAnimation ) &#123; </span><br><span class="line">        dlg.<span class="property">sourceGrp</span>.<span class="property">ignoreChildSetsCheck</span>.<span class="property">visible</span> = <span class="literal">false</span>;        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        dlg.<span class="property">sourceGrp</span>.<span class="property">ignoreChildSetsCheck</span>.<span class="property">visible</span> = <span class="literal">true</span>;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createDestDocWithOptions</span>(<span class="params">userOptions, srcDoc</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ( userOptions === <span class="literal">false</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sourceType = userOptions[kUserOptionsSourceKey];</span><br><span class="line">    <span class="keyword">var</span> layerSetIndex = userOptions[kUserOptionsLayerSetKey];</span><br><span class="line">    <span class="keyword">var</span> destDoc = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( sourceType == kUserOptionsSourceFrameAnimation ) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// How many frames in the animation?</span></span><br><span class="line">        <span class="keyword">var</span> frameCount = <span class="title function_">getFrameCount</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ( frameCount == <span class="number">0</span> ) &#123; </span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&quot;No animation frames were found in this file. In &#x27;Frame Animation&#x27; mode this script requires a Photo Frame animation to create a sprite sheet.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        destDoc = app.<span class="property">documents</span>.<span class="title function_">add</span>(srcDoc.<span class="property">width</span>, srcDoc.<span class="property">height</span>, srcDoc.<span class="property">resolution</span>, srcDoc.<span class="property">name</span> + <span class="string">&quot; Sheet&quot;</span>);    </span><br><span class="line">        <span class="title function_">copyAnimationFrames</span>(userOptions, srcDoc, destDoc, frameCount);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( sourceType == kUserOptionsSourceDocumentLayers ) </span><br><span class="line">    &#123;</span><br><span class="line">        destDoc = app.<span class="property">documents</span>.<span class="title function_">add</span>(srcDoc.<span class="property">width</span>, srcDoc.<span class="property">height</span>, srcDoc.<span class="property">resolution</span>, srcDoc.<span class="property">name</span> + <span class="string">&quot; Sheet&quot;</span>);            </span><br><span class="line">        <span class="title function_">copyLayersAsSprites</span>(userOptions, srcDoc, destDoc, srcDoc.<span class="property">layers</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( sourceType == kUserOptionsSourceLayerSet ) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ( layerSetIndex &gt;= srcDoc.<span class="property">layerSets</span>.<span class="property">length</span> ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&quot;The &#x27;Specific Layer Set&#x27; option was selected, but there is no selected layer set in the open document.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> ( srcDoc.<span class="property">layerSets</span>[layerSetIndex].<span class="property">layers</span>.<span class="property">length</span> == <span class="number">0</span> ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&quot;The selected layer set contains no layers.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        destDoc = app.<span class="property">documents</span>.<span class="title function_">add</span>(srcDoc.<span class="property">width</span>, srcDoc.<span class="property">height</span>, srcDoc.<span class="property">resolution</span>, srcDoc.<span class="property">name</span> + <span class="string">&quot; Sheet&quot;</span>);    </span><br><span class="line">        <span class="title function_">copyLayersAsSprites</span>(userOptions, srcDoc, destDoc, srcDoc.<span class="property">layerSets</span>[layerSetIndex].<span class="property">layers</span>);        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    app.<span class="property">activeDocument</span> = destDoc;</span><br><span class="line">    <span class="keyword">return</span> destDoc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copyAnimationFrames</span>(<span class="params">userOptions, srcDoc, destDoc, frameCount</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Copy Merged Frames across to new image</span></span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">1</span>; k &lt;= frameCount; k++ ) </span><br><span class="line">    &#123;</span><br><span class="line">        app.<span class="property">activeDocument</span> = srcDoc;</span><br><span class="line">        <span class="title function_">goToFrame</span>(k);</span><br><span class="line">        <span class="title function_">selectAllLayers</span>();</span><br><span class="line">        <span class="title function_">duplicateSelectedLayers</span>();</span><br><span class="line">        <span class="title function_">mergeSelectedLayers</span>();</span><br><span class="line">        <span class="keyword">var</span> layer = srcDoc.<span class="property">activeLayer</span>.<span class="title function_">duplicate</span>(destDoc, <span class="title class_">ElementPlacement</span>.<span class="property">PLACEATEND</span>);</span><br><span class="line">        <span class="title function_">deleteSelectedLayers</span>();</span><br><span class="line">        </span><br><span class="line">        app.<span class="property">activeDocument</span> = destDoc;</span><br><span class="line">        layer.<span class="property">name</span> = <span class="string">&quot;Frame &quot;</span> + k;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copyLayersAsSprites</span>(<span class="params">userOptions, srcDoc, destDoc, layers</span>)</span><br><span class="line">&#123;</span><br><span class="line">    app.<span class="property">activeDocument</span> = srcDoc;    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( srcDoc == <span class="literal">undefined</span> || destDoc == <span class="literal">undefined</span> || layers == <span class="literal">undefined</span> ) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&quot;copyLayersAsSprites called with undefined parameter(s).&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> wasVisible = [];</span><br><span class="line">    <span class="keyword">var</span> bgLayerIndex = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> wasParentVisible = <span class="literal">undefined</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Pre process</span></span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>; k &lt; layers.<span class="property">length</span>; k++ ) &#123;</span><br><span class="line">        wasVisible[k] = layers[k].<span class="property">visible</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( layers[k].<span class="property">isBackgroundLayer</span> ) &#123; </span><br><span class="line">            bgLayerIndex = k;</span><br><span class="line">            layers[k].<span class="property">isBackgroundLayer</span> = <span class="literal">false</span>;</span><br><span class="line">            layers[k].<span class="property">visible</span> = wasVisible[k]; <span class="comment">// Toggling background layer affects visibility</span></span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( layers[<span class="number">0</span>].<span class="property">parent</span>.<span class="property">visible</span> !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">        wasParentVisible = layers[<span class="number">0</span>].<span class="property">parent</span>.<span class="property">visible</span>;</span><br><span class="line">        layers[<span class="number">0</span>].<span class="property">parent</span>.<span class="property">visible</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Do the work</span></span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>; k &lt; layers.<span class="property">length</span>; k++ ) </span><br><span class="line">    &#123;</span><br><span class="line">        app.<span class="property">activeDocument</span> = srcDoc;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Don&#x27;t process background layer as it causes issues (probably don&#x27;t want it as a sprite anyway)</span></span><br><span class="line">        <span class="keyword">if</span> ( k == bgLayerIndex ) &#123; </span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// If we are ignoring child sets, check and skip if necessary</span></span><br><span class="line">        <span class="keyword">if</span> ( userOptions[kUserOptionsIgnoreChildSetsKey] &amp;&amp; layers[k].<span class="property">layers</span> !== <span class="literal">undefined</span> &amp;&amp; layers[k].<span class="property">layers</span>.<span class="property">length</span> &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Turn off all layers (but don&#x27;t mess with the background layer)</span></span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">var</span> j = <span class="number">0</span>; j &lt; layers.<span class="property">length</span>; j++ ) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( j != bgLayerIndex ) &#123;</span><br><span class="line">                layers[j].<span class="property">visible</span> = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Turn on active layer</span></span><br><span class="line">        layers[k].<span class="property">visible</span> = <span class="literal">true</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Turn into sprite!</span></span><br><span class="line">        <span class="title function_">selectAllLayers</span>();</span><br><span class="line">        <span class="title function_">duplicateSelectedLayers</span>();</span><br><span class="line">        <span class="title function_">mergeSelectedLayers</span>();</span><br><span class="line">        <span class="keyword">var</span> layer = srcDoc.<span class="property">activeLayer</span>.<span class="title function_">duplicate</span>(destDoc, <span class="title class_">ElementPlacement</span>.<span class="property">PLACEATEND</span>);</span><br><span class="line">        <span class="title function_">deleteSelectedLayers</span>();</span><br><span class="line">        </span><br><span class="line">        app.<span class="property">activeDocument</span> = destDoc;</span><br><span class="line">        layer.<span class="property">name</span> = <span class="string">&quot;Sprite &quot;</span> + (k + <span class="number">1</span>);     </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Undo Pre-Process</span></span><br><span class="line">    app.<span class="property">activeDocument</span> = srcDoc;    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>; k &lt; layers.<span class="property">length</span>; k++ ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( k == bgLayerIndex ) &#123;</span><br><span class="line">            layers[k].<span class="property">isBackgroundLayer</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>; k &lt; layers.<span class="property">length</span>; k++ ) &#123;</span><br><span class="line">        layers[k].<span class="property">visible</span> = wasVisible[k];    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( layers[<span class="number">0</span>].<span class="property">parent</span>.<span class="property">visible</span> !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">        layers[<span class="number">0</span>].<span class="property">parent</span>.<span class="property">visible</span> = wasParentVisible;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">atlasSizeForFrames</span>(<span class="params">userOptions, frameWidth, frameHeight, frameCount</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> atlasWidth = <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">var</span> atlasHeight = <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">var</span> didFit = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> fixedWidth = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> fixedHeight = <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( userOptions[kUserOptionsAtlasWidthKey] &gt; <span class="number">0</span> ) &#123; atlasWidth = userOptions[kUserOptionsAtlasWidthKey]; fixedWidth = <span class="literal">true</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> ( userOptions[kUserOptionsAtlasHeightKey] &gt; <span class="number">0</span> ) &#123; atlasHeight = userOptions[kUserOptionsAtlasHeightKey]; fixedHeight = <span class="literal">true</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( fixedWidth &amp;&amp; fixedHeight ) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="attr">width</span>: atlasWidth, <span class="attr">height</span>: atlasHeight&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">       </span><br><span class="line">    <span class="keyword">while</span>( didFit == <span class="literal">false</span> ) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> x = <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">var</span> y = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//$.writeln(&quot;Trying to fit &quot; + frameCount + &quot;x&quot; + frameWidth + &quot;x&quot; + frameHeight + &quot; onto: &quot; + atlasWidth + &quot; x &quot; + atlasHeight);</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> gridWidth = <span class="title class_">Math</span>.<span class="title function_">floor</span>(atlasWidth / frameWidth);</span><br><span class="line">        <span class="keyword">var</span> requiredGridHeight = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(frameCount / gridWidth);</span><br><span class="line">        <span class="keyword">var</span> requiredPixelHeight = requiredGridHeight * frameHeight;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ( requiredPixelHeight &gt; atlasHeight ) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ( (atlasWidth &lt;= atlasHeight) &amp;&amp; (fixedWidth == <span class="literal">false</span>) ) &#123; atlasWidth *= <span class="number">2</span>; &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123; atlasHeight *= <span class="number">2</span>; &#125;</span><br><span class="line">            </span><br><span class="line">            didFit = <span class="literal">false</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            didFit = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> result = &#123;<span class="attr">width</span>: atlasWidth, <span class="attr">height</span>: atlasHeight&#125;;</span><br><span class="line">    <span class="comment">//$.writeln(&quot;Atlas Size: &quot; + result.width + &quot; x &quot; + result.height);</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">layoutLayersAsSprites</span>(<span class="params">userOptions, destDoc</span>)</span><br><span class="line">&#123;</span><br><span class="line">    app.<span class="property">activeDocument</span> = destDoc;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Figure out atlas size</span></span><br><span class="line">    <span class="keyword">var</span> frameWidth = <span class="built_in">parseInt</span>(destDoc.<span class="property">width</span>);</span><br><span class="line">    <span class="keyword">var</span> frameHeight = <span class="built_in">parseInt</span>(destDoc.<span class="property">height</span>);</span><br><span class="line">    <span class="keyword">var</span> frameCount = destDoc.<span class="property">layers</span>.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">var</span> atlasSize = <span class="title function_">atlasSizeForFrames</span>(userOptions, frameWidth, frameHeight, frameCount);</span><br><span class="line">    destDoc.<span class="title function_">resizeCanvas</span>(atlasSize.<span class="property">width</span>, atlasSize.<span class="property">height</span>, <span class="title class_">AnchorPosition</span>.<span class="property">TOPLEFT</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Layout Layers</span></span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>; k &lt; frameCount; ++k ) </span><br><span class="line">    &#123;         </span><br><span class="line">        <span class="keyword">try</span> &#123; </span><br><span class="line">            destDoc.<span class="property">layers</span>[k].<span class="title function_">translate</span>(x, y);</span><br><span class="line">        &#125; <span class="keyword">catch</span> ( e ) &#123; &#125;</span><br><span class="line">        </span><br><span class="line">        x += frameWidth;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ( (x+frameWidth) &gt; atlasSize.<span class="property">width</span> ) </span><br><span class="line">        &#123;</span><br><span class="line">            x = <span class="number">0</span>;</span><br><span class="line">            y += frameHeight;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Layout sprites</span></span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>; k &lt; frameCount; k++ ) </span><br><span class="line">    &#123;</span><br><span class="line">        destDoc.<span class="property">layers</span>[k]</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( userOptions[kUserOptionsFlattenKey] == <span class="literal">true</span> ) &#123;</span><br><span class="line">        selectAllLayers ();</span><br><span class="line">        mergeSelectedLayers ();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Animation Actions</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Count the number of frames in the current frame animation (brute force, slow).</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getFrameCount</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">1</span>; k &lt; <span class="number">999</span>; k++ ) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="title function_">goToFrame</span>(k) == <span class="literal">false</span> ) &#123;</span><br><span class="line">            <span class="keyword">return</span> k - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Jump to the given frame in the frame animation in the active document</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">goToFrame</span>(<span class="params">jumpToFrame</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123; </span><br><span class="line">        <span class="keyword">var</span> desc = <span class="keyword">new</span> <span class="title class_">ActionDescriptor</span>();  </span><br><span class="line">        <span class="keyword">var</span> ref1 = <span class="keyword">new</span> <span class="title class_">ActionReference</span>();  </span><br><span class="line">        ref1.<span class="title function_">putIndex</span>( <span class="title function_">stringIDToTypeID</span>( <span class="string">&quot;animationFrameClass&quot;</span> ), jumpToFrame);  </span><br><span class="line">        desc.<span class="title function_">putReference</span>( <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;null&quot;</span> ), ref1 );  </span><br><span class="line">        <span class="title function_">executeAction</span>( <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;slct&quot;</span> ), desc, <span class="title class_">DialogModes</span>.<span class="property">NO</span> );  </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        </span><br><span class="line">     &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">         <span class="comment">//$.writeln(e);</span></span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Layer Editing Actions</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Select all layers in the active document</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">selectAllLayers</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> idselectAllLayers = <span class="title function_">stringIDToTypeID</span>( <span class="string">&quot;selectAllLayers&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> desc4 = <span class="keyword">new</span> <span class="title class_">ActionDescriptor</span>();</span><br><span class="line">    <span class="keyword">var</span> idnull = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;null&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> ref1 = <span class="keyword">new</span> <span class="title class_">ActionReference</span>();</span><br><span class="line">    <span class="keyword">var</span> idLyr = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Lyr &quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> idOrdn = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Ordn&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> idTrgt = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Trgt&quot;</span> );</span><br><span class="line">    ref1.<span class="title function_">putEnumerated</span>( idLyr, idOrdn, idTrgt );</span><br><span class="line">    desc4.<span class="title function_">putReference</span>( idnull, ref1 );</span><br><span class="line">    <span class="title function_">executeAction</span>( idselectAllLayers, desc4, <span class="title class_">DialogModes</span>.<span class="property">NO</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Duplicate all layers that are currently selected</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">duplicateSelectedLayers</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> idDplc = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Dplc&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> desc5 = <span class="keyword">new</span> <span class="title class_">ActionDescriptor</span>();</span><br><span class="line">    <span class="keyword">var</span> idnull = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;null&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> ref2 = <span class="keyword">new</span> <span class="title class_">ActionReference</span>();</span><br><span class="line">    <span class="keyword">var</span> idLyr = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Lyr &quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> idOrdn = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Ordn&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> idTrgt = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Trgt&quot;</span> );</span><br><span class="line">    ref2.<span class="title function_">putEnumerated</span>( idLyr, idOrdn, idTrgt );</span><br><span class="line">    desc5.<span class="title function_">putReference</span>( idnull, ref2 );</span><br><span class="line">    <span class="keyword">var</span> idVrsn = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Vrsn&quot;</span> );</span><br><span class="line">    desc5.<span class="title function_">putInteger</span>( idVrsn, <span class="number">2</span> );</span><br><span class="line">    <span class="title function_">executeAction</span>( idDplc, desc5, <span class="title class_">DialogModes</span>.<span class="property">NO</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Merge all currently selected layers</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mergeSelectedLayers</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> idMrgtwo = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Mrg2&quot;</span> );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="title function_">executeAction</span>( idMrgtwo, <span class="literal">undefined</span>, <span class="title class_">DialogModes</span>.<span class="property">NO</span> );</span><br><span class="line">    &#125; <span class="keyword">catch</span>( e ) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Delete all selected layers</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">deleteSelectedLayers</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Delete selected layers</span></span><br><span class="line">    <span class="keyword">var</span> idDlt = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Dlt &quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> desc8 = <span class="keyword">new</span> <span class="title class_">ActionDescriptor</span>();</span><br><span class="line">    <span class="keyword">var</span> idnull = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;null&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> ref6 = <span class="keyword">new</span> <span class="title class_">ActionReference</span>();</span><br><span class="line">    <span class="keyword">var</span> idLyr = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Lyr &quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> idOrdn = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Ordn&quot;</span> );</span><br><span class="line">    <span class="keyword">var</span> idTrgt = <span class="title function_">charIDToTypeID</span>( <span class="string">&quot;Trgt&quot;</span> );</span><br><span class="line">    ref6.<span class="title function_">putEnumerated</span>( idLyr, idOrdn, idTrgt );</span><br><span class="line">    desc8.<span class="title function_">putReference</span>( idnull, ref6 );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="title function_">executeAction</span>( idDlt, desc8, <span class="title class_">DialogModes</span>.<span class="property">NO</span> );</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>File Name: Sprite Sheet Generator 0.6.0.jsx
</code></pre>
</article><div class="post-copyright"><div class="post-copyright__author_group"><a class="post-copyright__author_img" href="/about/"><img class="post-copyright__author_img_front" src="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon"></a><div class="post-copyright__author_name">虎了吧唧</div><div class="post-copyright__author_desc"></div></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div id="quit-box" onclick="RemoveRewardMask()"></div><div class="post-reward"><div class="reward-button" title="Sponsor" onclick="AddRewardMask()"><i class="solitude st-hand-heart-fill"></i>Sponsor</div><div class="reward-main"><ul class="reward-all"><span class="reward-title">感谢您的赞赏。</span><ul class="reward-group"><li class="reward-item"><a target="_blank" rel="noopener" href="https://ko-fi.com/hulebaji/?hidefeed=true&amp;widget=true&amp;embed=true&amp;preview=true"><img class="post-qr-code-img nolazyload" src="https://bu.dusays.com/2024/04/26/662b9f91bef30.webp" alt="Ko-fi" style="border-color: var(--efu-purple)"></a><div class="post-qr-code-desc">Ko-fi</div></li><li class="reward-item"><a href="https://afdian.net/order/create?user_id=9755b3b450ad11ec976f52540025c377&amp;remark=&quot; target="><img class="post-qr-code-img nolazyload" src="https://bu.dusays.com/2024/04/26/662b9f83b0b6a.webp" alt="爱发电" style="border-color: var(--efu-black)"></a><div class="post-qr-code-desc">爱发电</div></li></ul><a class="reward-main-btn" href="/about"><div class="reward-text">List of appreciation</div><div class="reward-dec">因为有你们的支持，我才体会到写文章的价值。</div></a></ul></div></div><script>function RemoveRewardMask() {
    let rewardMainElements = document.querySelectorAll(".reward-main");
    let quitBoxElement = document.querySelector("#quit-box");

    rewardMainElements.forEach(element => {
        element.style.display = "none";
    });

    if (quitBoxElement) {
        quitBoxElement.style.display = "none";
    }
}

function AddRewardMask() {
    let rewardMainElements = document.querySelectorAll(".reward-main");
    let quitBoxElement = document.querySelector("#quit-box");

    rewardMainElements.forEach(element => {
        element.style.display = "flex";
    });

    if (quitBoxElement) {
        quitBoxElement.style.display = "flex";
    }
}</script><div class="reward-link mode"><a class="reward-link-button" href="/atom.xml"><i class="solitude st-plant-fill"></i>Subscribe</a></div></div></div><div class="social-share"><a class="social-share-ico icon-qq" target="_blank" rel="noopener" href="https://connect.qq.com/widget/shareqq/index.html?url=https%3A%2F%2Fblog.hulebaji.me%2Fposts%2F51799%2F&amp;title=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC&amp;desc=undefined&amp;summary=undefined&amp;site=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC&amp;pics=https%3A%2F%2Fassets.hulebaji.me%2F2022%2F5d3ea6785dfd1d53e8330f9239dd94a1.webp" title="Share to QQ"><i class="solitude st-qq-fill"></i></a><a class="social-share-ico icon-weibo" target="_blank" rel="noopener" href="http://service.weibo.com/share/share.php?url=https%3A%2F%2Fblog.hulebaji.me%2Fposts%2F51799%2F&amp;title=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC&amp;pic=https%3A%2F%2Fassets.hulebaji.me%2F2022%2F5d3ea6785dfd1d53e8330f9239dd94a1.webp" title="Share to Weibo"><i class="solitude st-weibo-fill"></i></a><a class="social-share-ico icon-twitter" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.hulebaji.me%2Fposts%2F51799%2F&amp;text=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC" title="Share to Twitter"><i class="solitude st-twitter-x-fill"></i></a><a class="social-share-ico icon-facebook" target="_blank" rel="noopener" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.hulebaji.me%2Fposts%2F51799%2F" title="Share to Facebook"><i class="solitude st-facebook-fill"></i></a><a class="social-share-ico icon-telegram" target="_blank" rel="noopener" href="https://t.me/share/url?url=https%3A%2F%2Fblog.hulebaji.me%2Fposts%2F51799%2F&amp;text=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC" title="Share to Telegram"><i class="solitude st-telegram-fill"></i></a><a class="social-share-ico icon-whatsapp" target="_blank" rel="noopener" href="https://api.whatsapp.com/send?text=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC https%3A%2F%2Fblog.hulebaji.me%2Fposts%2F51799%2F" title="Share to WhatsApp"><i class="solitude st-whatsapp-fill"></i></a><a class="social-share-ico icon-linkedin" target="_blank" rel="noopener" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fblog.hulebaji.me%2Fposts%2F51799%2F&amp;title=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC&amp;summary=undefined&amp;source=PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E5%AF%BC%E5%87%BA%E8%84%9A%E6%9C%AC" title="Share to LinkedIn"><i class="solitude st-linkedin-box-fill"></i></a></div><div class="post-copyright__notice"><span class="post-copyright-info">This piece of writing is an original article, utilizing the<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>Agreement. For complete reproduction, please acknowledge the source as Courtesy of<a href="/">虎了吧唧</a></span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Script/"><span class="tags-punctuation"></span>Script<span class="tagsPageCount">1</span></a><a class="post-meta__tags" href="/tags/Photo-Shop/"><span class="tags-punctuation"></span>Photo Shop<span class="tagsPageCount">1</span></a></div></div></div><nav class="needEndHide pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/37930/"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">傩文化速记</div></div></a></div><div class="next-post pull-right"><a href="/posts/64940/"><div class="pagination-info"><div class="label">Next</div><div class="next_info">Blender毛茸茸质感探究</div></div></a></div></nav><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="solitude st-chat-fill"></i><span>  Comment</span></div></div><div class="comment-wrap"><div id="twikoo-wrap"></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><div class="author-info__top-group"><div class="author-info__sayhi" id="author-info__sayhi" onclick="sco.changeSayHelloText()">sayhello.morning</div></div></div><div class="avatar-img-group"><img class="avatar-img" alt="Avatar" src="https://bu.dusays.com/2024/01/23/65afadfe6f177.webp"><div class="avatar-sticker"><img class="avatar-sticker-img" src="https://7.isyangs.cn/34/65f2e4e0423cc-34.png" alt="Mood sticker"></div></div><div class="author-info__description_group"><div class="author-info__description">分享自己对编程的<b>热爱</b>，对美好生活的<b>向往</b>，对知识海洋<b>探索历程</b>。</div><div class="author-info__description2">相信你可以在这里找到对你有用的知识和教程。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about/"><div class="author-info__name">Ian Tsang</div><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon" target="_blank" rel="noopener" href="https://github.com/hulebaji" title="Github"><i class="solitude  st-github-line"></i></a><a class="social-icon" target="_blank" rel="noopener" href="https://space.bilibili.com/1329819902" title="Bilibili"><i class="solitude  iconfont hulebaji-x"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="solitude st-menu-line"></i><span>Table of contents</span></div><div class="toc-content" id="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PS%E5%8A%A8%E7%94%BB%E5%BA%8F%E5%88%97%E7%B2%BE%E7%81%B5%E8%A1%A8%E8%84%9A%E6%9C%AC"><span class="toc-text">PS动画序列精灵表脚本</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A5%E4%B8%8B%E6%98%AF%E8%84%9A%E6%9C%AC%E5%8E%9F%E4%BD%9C%E8%80%85%E5%8E%9F%E6%96%87"><span class="toc-text">以下是脚本原作者原文</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Photoshop-Sprite-Sheet-Generator-Script"><span class="toc-text">Photoshop: Sprite Sheet Generator Script</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Download"><span class="toc-text">Download</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Installation"><span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Usage"><span class="toc-text">Usage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#License"><span class="toc-text">License</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A5%E4%B8%8B%E4%B8%BA%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6%E7%9A%84%E8%A7%A3%E7%A0%81%EF%BC%88%E4%BB%A5%E9%98%B2%E6%96%87%E4%BB%B6%E6%8D%9F%E5%A4%B1%EF%BC%89"><span class="toc-text">以下为脚本文件的解码（以防文件损失）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="solitude st-map-line"></i><span>New posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/48912/" title="我在义乌当美工"><img alt="我在义乌当美工" src="https://bu.dusays.com/2024/02/05/65c0e8b261f17.webp"></a><div class="content"><a class="title" href="/posts/48912/" title="我在义乌当美工">我在义乌当美工</a><a class="article-recent_post_categories" href="/posts/48912/">笔记/Note</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/65362/" title="快速修复Blender中模型ASCII FBX导入错误"><img alt="快速修复Blender中模型ASCII FBX导入错误" src="https://assets.hulebaji.me/HulebajiAssets/2023/8e42923fb3efc0155c8700499e0a7904.webp"></a><div class="content"><a class="title" href="/posts/65362/" title="快速修复Blender中模型ASCII FBX导入错误">快速修复Blender中模型ASCII FBX导入错误</a><a class="article-recent_post_categories" href="/posts/65362/">笔记/Note</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/32748/" title="windows 桌面图标空白解决方法"><img alt="windows 桌面图标空白解决方法" src="https://assets.hulebaji.me/HulebajiAssets/2023/51e86e8a5cf7edd1f0759ba72f322ce9.webp"></a><div class="content"><a class="title" href="/posts/32748/" title="windows 桌面图标空白解决方法">windows 桌面图标空白解决方法</a><a class="article-recent_post_categories" href="/posts/32748/">笔记/Note</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/37873/" title="UE5缺少SDK，而无法在windows平台打包的解决方法"><img alt="UE5缺少SDK，而无法在windows平台打包的解决方法" src="https://assets.hulebaji.me/HulebajiAssets/2023/02b93b84b43ad8938458e52d4b252970.webp"></a><div class="content"><a class="title" href="/posts/37873/" title="UE5缺少SDK，而无法在windows平台打包的解决方法">UE5缺少SDK，而无法在windows平台打包的解决方法</a><a class="article-recent_post_categories" href="/posts/37873/">笔记/Note</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/26006/" title="UE最大化窗口黑屏，右键菜单闪烁不显示及其他相似显示的问题处理办法"><img alt="UE最大化窗口黑屏，右键菜单闪烁不显示及其他相似显示的问题处理办法" src="https://assets.hulebaji.me/HulebajiAssets/2023/4d0beea01ddf433541be95ff4899549e.webp"></a><div class="content"><a class="title" href="/posts/26006/" title="UE最大化窗口黑屏，右键菜单闪烁不显示及其他相似显示的问题处理办法">UE最大化窗口黑屏，右键菜单闪烁不显示及其他相似显示的问题处理办法</a><a class="article-recent_post_categories" href="/posts/26006/">笔记/Note</a></div></div></div></div></div></div></main><footer id="footer"><div id="st-footer-bar"><div class="footer-logo"><span>虎了吧唧</span></div><div class="footer-bar-description">来自 Ian 的文章</div><a class="footer-bar-link" href="/about/">了解更多</a></div><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/hulebaji" title="Github"><i class="solitude  st-github-line"></i></a><a class="deal_link" href="mailto:hulebaji@pm.me" title="Mail"><i class="solitude  st-mail-line"></i></a><div class="nolazyload footer_mini_logo" id="footer_mini_logo" title="Back to top" onclick="sco.toTop()"><img src= "/img/loading.gif" data-lazy-src="https://cravatar.cn/avatar/c126bb295caa6f29cbbd32083708cda4?d=identicon" alt="Back to top"></div><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/354836931" title="Bilibili"><i class="solitude  st-bilibili-line"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://twitter.com/hulebaji/" title="X"><i class="solitude  iconfont hulebaji-x"></i></a></div><div id="st-footer"><div class="footer-group"><h3 class="footer-title">导航</h3><div class="footer-links"><a class="footer-item" href="/archives/" title="归档">归档</a><a class="footer-item" href="/categories/" title="分类">分类</a><a class="footer-item" href="/tags/" title="标签">标签</a></div></div><div class="footer-group"><h3 class="footer-title">服务</h3><div class="footer-links"><a class="footer-item" target="_blank" rel="noopener" href="https://Nx8KKXil.jutuike.cn/#/?code=Nx8KKXil" title="吃喝玩乐鸭">吃喝玩乐鸭</a><a class="footer-item" target="_blank" rel="noopener" href="https://v6.51.la/" title="51la统计">51la统计</a><a class="footer-item" target="_blank" rel="noopener" href="https://tongji.baidu.com/" title="百度统计">百度统计</a></div></div><div class="footer-group"><h3 class="footer-title">支持</h3><div class="footer-links"><a class="footer-item" href="/about/" title="打赏记录">打赏记录</a></div></div><div class="footer-group"><h3 class="footer-title">协议</h3><div class="footer-links"><a class="footer-item" href="/cookies/" title="Cookies">Cookies</a><a class="footer-item" href="/privacy/" title="用户协议">用户协议</a><a class="footer-item" href="/copyright/" title="版权协议">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><h3 class="footer-title">Links</h3><button class="random-friends-btn" onclick="randomLinksList()" title="Links"><i class="solitude st-refresh-line"></i></button></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div class="copyright">© 2024 By&nbsp;<a class="footer-bar-link" href="/">Ian Tsang</a></div></div><div class="footer-bar-right"><a class="footer-bar-link" href="/atom.xml" alt="订阅">订阅</a><a class="footer-bar-link cc" href="/license/" aria-label="copyright"><i class="solitude st-copyright-line"></i><i class="solitude st-creative-commons-by-line"></i><i class="solitude st-creative-commons-nc-line"></i><i class="solitude st-creative-commons-nd-line"></i></a></div></div></div><div class="needEndHide" id="cookies-window"><div class="cookies-window-title">Agreement reminder assistant</div><div class="cookies-window-content"><span class="cookies-tip">Check out the efforts we make to protect your privacy</span><a class="cookies-link" href="/privacy/" title="How this site protects your privacy"><i class="solitude st-right-btn-fill"></i></a></div></div><div class="comment-barrage needEndHide"></div></footer></div><!-- right_menu--><!-- inject body--><div><script src="/js/utils.js?v=1.12.2"></script><script src="/js/main.js?v=1.12.2"></script><script src="/js/third_party/waterfall.min.js?v=1.12.2"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/js/third_party/universe.min.js?v=1.12.2"></script><script>dark()
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/19.1.3/lazyload.iife.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/node-snackbar/0.1.16/snackbar.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.36/fancybox/fancybox.umd.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js"></script><script>var meting_api = 'https://meting.qjqq.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r';</script><script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/meting/2.0.1/Meting.min.js"></script><script>const coverColorConfig = {
    api: 'https://img2color.hulebaji.me/api?img=',
    time: 43200000
}</script><script src="/js/covercolor/api.js?v=1.12.2"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.70.0/instantsearch.production.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.23.3/algoliasearch-lite.umd.min.js"></script><div class="js-pjax"><script>(() => {
    const getCount = () => {
        const ele = document.querySelectorAll('.twikoo-count')
        if (!ele) return
        twikoo.getCommentsCount({
            envId: 'https://twikoo.hulebaji.me',
            region: '',
            urls: [window.location.pathname],
            includeReply: false
        }).then(res => {
            ele.forEach(item => item.textContent = res[0].count)
        }).catch(err => {
            console.error(err)
        })
    }
    const init = () => {
        twikoo.init(Object.assign({
            el: '#twikoo-wrap',
            envId: 'https://twikoo.hulebaji.me',
            region: '',
            path: window.location.pathname,
            onCommentLoaded: () => {
                GLOBAL_CONFIG.lightbox && utils.lightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
            }
        }, null))

        
        sco.owoBig({
            body: '.OwO-body',
            item: '.OwO-items li'
        })

        true && barrageTwikoo()
    }

    const loadTwikoo = () => {
        if (typeof twikoo === 'object') setTimeout(init,0)
        else utils.getScript('https://cdnjs.cloudflare.com/ajax/libs/twikoo/1.6.36/twikoo.all.min.js').then(init)
    }

    if ('Twikoo' === 'Twikoo' || true) {
        if (true) utils.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
        else loadTwikoo()
    } else {
        window.loadTwoComment = loadTwikoo
    }
})()
</script><script>async function barrageTwikoo() {
    await fetch("https://twikoo.hulebaji.me", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            event: "COMMENT_GET",
            accessToken: "",
            url: window.location.pathname
        })
    }).then(async res => {
        if (!res.ok) throw new Error("HTTP error! status: " + res.status)
        const data = await res.json();
        const init = () => {
            initializeCommentBarrage((data.data).map(item => Object.assign({
                content: item.comment,
                nick: item.nick,
                mailMd5: item.mailMd5,
                id: item.id
            })))
        }
        if (typeof initializeCommentBarrage === "undefined") await utils.getScript('/js/third_party/barrage.min.js?v=1.12.2').then(init)
        else init()
    }).catch(error => console.error("An error occurred while fetching comments: ", error))
}</script><script defer pjax src="https://cdnjs.cloudflare.com/ajax/libs/busuanzi/2.3.0/bsz.pure.mini.min.js"></script></div></div><script>const links = [{"name":"MC-Sep","link":"https://mc-sep.pages.dev/"},{"name":"LogDict","link":"https://www.logdict.com"},{"name":"echeverra","link":"https://echeverra.cn"},{"name":"爱吃肉的猫","link":"https://meuicat.com/"},{"name":"Shine","link":"https://blog.shineyu.cn/"},{"name":"CC康纳百川","link":"https://blog.ccknbc.cc"},{"name":"湘铭`Blog","link":"https://blog.xiangming.site/"},{"name":"朝而往","link":"https://muerg.cn/"},{"name":"Mxne","link":"https://blog.mxne.cn/"},{"name":"Eurkon","link":"https://blog.eurkon.com"},{"name":"ichika","link":"https://ichika.cc"},{"name":"haloged","link":"https://haloged.eu.org"},{"name":"雨夜回廊","link":"https://myql.eu.org/"},{"name":"安知鱼","link":"https://blog.anheyu.com/"},{"name":"Efu","link":"https://www.efu.me/"},{"name":"张洪Heo","link":"https://blog.zhheo.com/"},{"name":"杜老师说","link":"https://dusays.com"}]
const randomText = 'Click the button to visit a random link. The safety and availability of the destination website are not guaranteed. The random link for this visit is: ⌈ ${name} ⌋ '
function travelling() {
    const link = links[utils.randomNum(links.length)];
    Snackbar.show({
        text: randomText.replace(/\$\{name}/,link.name),
        duration: 8000,
        pos: 'top-center',
        actionText: 'To',
        onActionClick: function(element) {
            element.style.opacity = 0;
            window.open(link.link, '_blank');
        }
    });
}
</script><script>function randomLinksList() {
    const linkcard = document.getElementById('friend-links-in-footer');
    if (linkcard == null) return;

    let data = '';
    let linksCopy = [...links];
    let count = Math.min(3, linksCopy.length);

    for (let i = 0; i < count; i++) {
        let index = utils.randomNum(linksCopy.length);
        const {link, name} = linksCopy[index];
        data += `<a class="footer-item" href="${link}" target="_blank" rel="noopener noreferrer nofollow">${name}</a>`;
        linksCopy.splice(index, 1);
    }

    linkcard.innerHTML = data + '<a class="footer-item" href="/links/">More</a>';
}</script><!-- pjax--><script>const pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: ['title','#body-wrap','#site-config','meta[name="description"]','.js-pjax','meta[property^="og:"]','#config-diff'],
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
})

document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
})

document.addEventListener('pjax:complete', () => {
    window.refreshFn()

    document.querySelectorAll('script[data-pjax]').forEach(item => {
        const newScript = document.createElement('script')
        const content = item.text || item.textContent || item.innerHTML || ""
        Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
        newScript.appendChild(document.createTextNode(content))
        item.parentNode.replaceChild(newScript, item)
    })

    GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

})

document.addEventListener('pjax:error', (e) => {
    if (e.request.status === 404) {
        pjax.loadUrl('/404.html')
    }
})</script><!-- theme--><script>initTheme = () => {
    let isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const cachedMode = utils.saveToLocal.get('theme');
    if (cachedMode === undefined) {
        const nowMode =
            isDarkMode ? 'dark' : 'light'
        document.documentElement.setAttribute('data-theme', nowMode);
    } else {
        document.documentElement.setAttribute('data-theme', cachedMode);
    }
    typeof rm === 'object' && rm.mode(cachedMode === 'dark' && isDarkMode)
}
initTheme()</script><!-- google adsense--><!-- search--><div id="algolia-search"><div class="search-dialog"><div class="algolia-navbar"><div class="search-dialog__title" id="algolia-search-title">Search</div><div class="algolia-tips"><i class="solitude st-algolia-fill"></i><span class="algolia-tips-text">Algolia</span></div><span class="search-close-button"><i class="solitude st-close-fill"></i></span></div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><div id="search-results"><div id="algolia-hits"></div></div><div id="algolia-tips"><div id="algolia-pagination"></div><div id="algolia-stats"></div></div></div><div id="search-mask"></div></div><script src="/js/search/algolia.js?v=1.12.2"></script><!-- Tianli-Talk--><!-- music--><div class="needEndHide" id="nav-music" onclick="sco.musicToggle()"><div id="nav-music-hoverTips">Paused</div><meting-js id="7217966140" server="netease" type="playlist" mutex="true" preload="none" data-lrctype="0" order="random" theme="var(--efu-main)"></meting-js></div></body></html><script>const posts=["posts/37930/","posts/37494/","posts/23187/","posts/48912/","posts/9230/","posts/35494/","posts/b88ed928/","posts/29253/","posts/16440/","posts/16107/","posts/51799/","posts/64940/","posts/28074/","posts/7903/","posts/46332/","posts/17463/","posts/59255/","posts/32748/","posts/47511/","posts/c9a0f0cf/","posts/32663/","posts/8407109a/","posts/56424/","posts/26963/","posts/20560/","posts/34123/","posts/43837/","posts/65362/","posts/27852/","posts/32619/","posts/37873/","posts/26006/","posts/3d464277/","posts/50003/"];function toRandomPost(){ pjax.loadUrl('/'+posts[Math.floor(Math.random()*posts.length)]); }</script>